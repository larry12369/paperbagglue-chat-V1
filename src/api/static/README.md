# 网站聊天组件集成指南

## 问题说明

您的网站后台"客服代码"输入框有**2000字符限制**，而完整的聊天组件代码约4000-5000字符，无法直接粘贴。

## 解决方案

采用**静态文件加载方案**：
1. 完整代码托管在Render服务的 `/static/chat-widget.js`
2. 网站后台只需粘贴一段**简短的引用代码**（约200字符）
3. 浏览器自动从Render加载完整组件

---

## 📋 操作步骤

### 第一步：获取引用代码

复制以下代码（约180字符）：

```javascript
(function(){
  var d=document,w=window,s=d.createElement('script'),h=d.getElementsByTagName('head')[0]||d.documentElement;
  s.async=true;
  s.src='https://paperbagglue-chat.onrender.com/static/chat-widget.js?v='+Date.now();
  s.charset='UTF-8';
  h.appendChild(s);
})();
```

### 第二步：粘贴到网站后台

1. 回到您的网站后台
2. 找到"客服代码"输入框
3. 粘贴上面的代码
4. 保存设置

### 第三步：测试

1. 刷新您的网站 `www.paperbagglue.com`
2. 查看右下角是否出现绿色圆形聊天按钮
3. 点击按钮测试聊天功能

---

## 🎨 功能特性

### 界面设计
- ✅ 绿色主题（符合品牌色 #00A859）
- ✅ 悬浮聊天按钮（右下角）
- ✅ 渐变背景效果
- ✅ 响应式设计（适配手机）

### 聊天功能
- ✅ 自动欢迎消息
- ✅ 实时AI对话
- ✅ 打字动画效果
- ✅ 消息气泡样式
- ✅ 自动链接识别

### 技术特性
- ✅ 纯前端组件
- ✅ 自动会话管理
- ✅ 错误处理
- ✅ Enter发送/Shift+Enter换行

---

## 🔧 自定义配置

如需修改欢迎语或样式，请联系技术支持修改 `chat-widget.js` 文件。

---

## 📱 预览效果

集成后，网站会显示：

```
┌─────────────────────────┐
│  [绿色圆形按钮] 咨询     │  ← 右下角悬浮按钮
└─────────────────────────┘

点击后弹出聊天窗口：

┌──────────────────────────────┐
│ Larry Chen ● 在线          × │  ← 头部
├──────────────────────────────┤
│ 您好！我是Larry Chen。👋     │
│ 我可以帮您：                │  ← 欢迎消息
│ • 推荐环保水性胶水          │
│ • 提供技术参数              │
│ • 解答生产问题              │
│ • 获取报价和样品            │
├──────────────────────────────┤
│ [输入您的问题...]     [发送] │  ← 输入区域
└──────────────────────────────┘
```

---

## 🌐 文件说明

### 1. chat-widget.js
- **路径**: `src/api/static/chat-widget.js`
- **大小**: ~4000字符
- **用途**: 完整的聊天组件代码（HTML + CSS + JavaScript）
- **访问URL**: `https://paperbagglue-chat.onrender.com/static/chat-widget.js`

### 2. embed-code.js
- **路径**: `src/api/static/embed-code.js`
- **大小**: ~180字符
- **用途**: 简短的引用代码（粘贴到网站后台）
- **功能**: 动态加载 `chat-widget.js`

---

## 🔗 API集成

聊天组件会自动调用以下API：

### POST /api/chat
- **功能**: 获取AI回复
- **请求**: `{"message": "用户问题", "session_id": "会话ID"}`
- **返回**: `{"response": "AI回复", "session_id": "会话ID"}`

### GET /static/chat-widget.js
- **功能**: 提供聊天组件代码
- **返回**: JavaScript代码

---

## ✅ 验证清单

集成后请验证以下功能：

- [ ] 右下角显示绿色聊天按钮
- [ ] 点击按钮弹出聊天窗口
- [ ] 显示欢迎消息
- [ ] 输入框可输入文字
- [ ] 按Enter发送消息
- [ ] AI正常回复
- [ ] 移动端显示正常

---

## ❓ 常见问题

### Q1: 粘贴代码后没有聊天按钮？
**A**: 
1. 清除浏览器缓存（Ctrl+Shift+Delete）
2. 刷新页面
3. 检查浏览器控制台是否有错误（F12）

### Q2: 聊天窗口无法打开？
**A**:
1. 检查网络连接
2. 确认Render服务正常运行
3. 查看浏览器控制台错误信息

### Q3: AI不回复？
**A**:
1. 检查Render API服务是否正常
2. 确认 `/api/chat` 接口可访问
3. 查看Render日志

### Q4: 想修改欢迎语？
**A**: 需要修改 `chat-widget.js` 中的欢迎消息内容，请联系技术支持。

---

## 📞 技术支持

如有问题，请联系：
- 📧 Email: LarryChen@paperbagglue.com
- 📱 WhatsApp: +8613323273311

---

## 📝 版本信息

- **版本**: 1.0.0
- **发布日期**: 2025-01-18
- **兼容性**: 支持现代浏览器（Chrome、Firefox、Safari、Edge）
